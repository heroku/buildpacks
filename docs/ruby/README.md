<!-- STOP
  This file was generated by a rundoc script, do not modify it.

  Instead modify the rundoc script and re-run it.

  Command: /home/runner/work/buildpacks/buildpacks/.rundoc-workspace/vendor/bundle/ruby/3.3.0/bin/rundoc ../docs/src/ruby/ruby_tutorial.md
STOP -->
# Heroku Ruby Cloud Native Buildpack (CNB) Tutorial

Build a Ruby on Rails application image in 5 minutes, no Dockerfile required.

At the end of this tutorial, you'll have a working [OCI image](https://opencontainers.org/) of a Ruby on Rails application that can run locally. You will learn about the Cloud Native Buildpack (CNB) ecosystem, and how to utilize the [pack CLI](https://buildpacks.io/docs/for-platform-operators/how-to/integrate-ci/pack/) to build images without the need to write or maintain a Dockerfile.

## Install the pack CLI

We assume you have [docker installed](https://docs.docker.com/engine/install/) and a working copy [of git](https://github.com/git-guides/install-git). Next, you will need to install the CLI tool for building CNBs, [pack CLI](https://buildpacks.io/docs/for-platform-operators/how-to/integrate-ci/pack/). If you're on a Mac you can install it via Homebrew:

```
$ brew install buildpacks/tap/pack
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

Ensure that `pack` is installed correctly:

```
$ pack --version
0.34.2+git-ce8db3c.build-6005
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

## Configure the default pack builder

Once `pack` is installed, the only configuration you'll need for this tutorial is to set a default builder:

```
$ pack config default-builder heroku/builder:22
Builder 'heroku/builder:22' is now the default builder
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

You can view your default builder at any time:

```
$ pack config default-builder
The current default builder is 'heroku/builder:22'
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

The following tutorial is built on amd64 architecture (also known as x86). If you are building on a machine with different architecture (such as arm64/aarch64 for a Mac) you will need to tell Docker to use `linux/amd64` architecture. You can do this via a `--platform linux/amd64` flag or by exporting an environment variable:

```
$ export DOCKER_DEFAULT_PLATFORM=linux/amd64
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

## What is a builder?

> [!NOTE]
> Skip ahead if you want to build the application first and get into the details later. You won't need to
> know about builders for the rest of this tutorial.

In short, a builder is a delivery mechanism for buildpacks. A builder contains references to base images and individual buildpacks. A base image contains the operating system and system dependencies. Buildpacks are the components that will configure an image to run your application, that’s where the bulk of the logic lives and why the project is called “Cloud Native Buildpacks” and not “Cloud Native Builders.”

You can view the contents of a builder via the command `pack builder inspect`. For example:

```
$ pack builder inspect heroku/builder:22 | grep Buildpacks: -m1 -A10
Buildpacks:
  ID                                NAME                               VERSION        HOMEPAGE
  heroku/go                         Heroku Go                          0.4.1          https://github.com/heroku/buildpacks-go
  heroku/gradle                     Heroku Gradle                      6.0.1          https://github.com/heroku/buildpacks-jvm
  heroku/java                       Heroku Java                        6.0.1          https://github.com/heroku/buildpacks-jvm
  heroku/jvm                        Heroku OpenJDK                     6.0.1          https://github.com/heroku/buildpacks-jvm
  heroku/maven                      Heroku Maven                       6.0.1          https://github.com/heroku/buildpacks-jvm
  heroku/nodejs                     Heroku Node.js                     3.2.9          https://github.com/heroku/buildpacks-nodejs
  heroku/nodejs-corepack            Heroku Node.js Corepack            3.2.9          https://github.com/heroku/buildpacks-nodejs
  heroku/nodejs-engine              Heroku Node.js Engine              3.2.9          https://github.com/heroku/buildpacks-nodejs
  heroku/nodejs-npm-engine          Heroku Node.js npm Engine          3.2.9          https://github.com/heroku/buildpacks-nodejs
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

> [!NOTE]
> Your output version numbers may differ.

This output shows the various buildpacks that represent the different languages that are supported by this builder such as `heroku/go` and `heroku/nodejs-engine`.

## Download an example Ruby on Rails application

How do you configure a CNB? Give them an application. While Dockerfile is procedural, buildpacks, are declarative. A buildpack will determine what your application needs to function by inspecting the code on disk.

For this example, we're using a pre-built Ruby on Rails application. Download it now:

```
$ git clone https://github.com/heroku/ruby-getting-started
$ cd ruby-getting-started
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

Verify you're in the correct directory:

```
$ ls
Gemfile
Gemfile.lock
Procfile
README.md
Rakefile
app
app.json
bin
config
config.ru
db
lib
log
package.json
public
test
vendor
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

This tutorial was built using the following commit SHA:

```
$ git log --oneline | head -n1
035249f Bump rails from 7.1.3 to 7.1.3.2 (#137)
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

## Build the application image with the pack CLI

Now build an image named `my-image-name` by executing the heroku builder against the application by running the
`pack build` command:

```
$ pack build my-image-name --path .
[2024-07-22 19:25:24] 22: Pulling from heroku/builder
[2024-07-22 19:25:24] 9b857f539cb1: Pulling fs layer
[2024-07-22 19:25:24] 7af71cb397b9: Pulling fs layer
[2024-07-22 19:25:24] 0dea8f52227b: Pulling fs layer
[2024-07-22 19:25:24] 881b32f67d5f: Pulling fs layer
[2024-07-22 19:25:24] 182afb1fe5dc: Pulling fs layer
[2024-07-22 19:25:24] eef3e9640d29: Pulling fs layer
[2024-07-22 19:25:24] b7df828c981a: Pulling fs layer
[2024-07-22 19:25:24] 05866839ed8e: Pulling fs layer
[2024-07-22 19:25:24] 1e4c68ff7df8: Pulling fs layer
[2024-07-22 19:25:24] aac7f4f5dfbd: Pulling fs layer
[2024-07-22 19:25:24] 881b32f67d5f: Waiting
[2024-07-22 19:25:24] 7ad8b309ac9a: Pulling fs layer
[2024-07-22 19:25:24] 47237141b1fe: Pulling fs layer
[2024-07-22 19:25:24] 182afb1fe5dc: Waiting
[2024-07-22 19:25:24] 08d359555ab8: Pulling fs layer
[2024-07-22 19:25:24] 42bb88b3690e: Pulling fs layer
[2024-07-22 19:25:24] a2e8d3270011: Pulling fs layer
[2024-07-22 19:25:24] 61aa9f9f5090: Pulling fs layer
[2024-07-22 19:25:24] 57e63866fe46: Pulling fs layer
[2024-07-22 19:25:24] 454745ed8d31: Pulling fs layer
[2024-07-22 19:25:24] c6e4e9583515: Pulling fs layer
[2024-07-22 19:25:24] 464eddc5e83b: Pulling fs layer
[2024-07-22 19:25:24] 2c910edb2a09: Pulling fs layer
[2024-07-22 19:25:24] b886be5769bb: Pulling fs layer
[2024-07-22 19:25:24] c65710a064c1: Pulling fs layer
[2024-07-22 19:25:24] a8aa3cd86a13: Pulling fs layer
[2024-07-22 19:25:24] 0948dd96497c: Pulling fs layer
[2024-07-22 19:25:24] e90c3615a082: Pulling fs layer
[2024-07-22 19:25:24] dcc7df304966: Pulling fs layer
[2024-07-22 19:25:24] b9f6de2761b9: Pulling fs layer
[2024-07-22 19:25:24] 4f4fb700ef54: Pulling fs layer
[2024-07-22 19:25:24] eef3e9640d29: Waiting
[2024-07-22 19:25:24] b7df828c981a: Waiting
[2024-07-22 19:25:24] 0948dd96497c: Waiting
[2024-07-22 19:25:24] 464eddc5e83b: Waiting
[2024-07-22 19:25:24] e90c3615a082: Waiting
[2024-07-22 19:25:24] 2c910edb2a09: Waiting
[2024-07-22 19:25:24] dcc7df304966: Waiting
[2024-07-22 19:25:24] b886be5769bb: Waiting
[2024-07-22 19:25:24] b9f6de2761b9: Waiting
[2024-07-22 19:25:24] c65710a064c1: Waiting
[2024-07-22 19:25:24] 4f4fb700ef54: Waiting
[2024-07-22 19:25:24] a8aa3cd86a13: Waiting
[2024-07-22 19:25:24] 42bb88b3690e: Waiting
[2024-07-22 19:25:24] 1e4c68ff7df8: Waiting
[2024-07-22 19:25:24] a2e8d3270011: Waiting
[2024-07-22 19:25:24] aac7f4f5dfbd: Waiting
[2024-07-22 19:25:24] 61aa9f9f5090: Waiting
[2024-07-22 19:25:24] 7ad8b309ac9a: Waiting
[2024-07-22 19:25:24] 57e63866fe46: Waiting
[2024-07-22 19:25:24] 47237141b1fe: Waiting
[2024-07-22 19:25:24] 08d359555ab8: Waiting
[2024-07-22 19:25:24] c6e4e9583515: Waiting
[2024-07-22 19:25:24] 9b857f539cb1: Verifying Checksum
[2024-07-22 19:25:24] 9b857f539cb1: Download complete
[2024-07-22 19:25:24] 881b32f67d5f: Verifying Checksum
[2024-07-22 19:25:24] 881b32f67d5f: Download complete
[2024-07-22 19:25:24] 182afb1fe5dc: Verifying Checksum
[2024-07-22 19:25:24] 182afb1fe5dc: Download complete
[2024-07-22 19:25:25] eef3e9640d29: Verifying Checksum
[2024-07-22 19:25:25] eef3e9640d29: Download complete
[2024-07-22 19:25:25] b7df828c981a: Verifying Checksum
[2024-07-22 19:25:25] b7df828c981a: Download complete
[2024-07-22 19:25:25] 05866839ed8e: Verifying Checksum
[2024-07-22 19:25:25] 05866839ed8e: Download complete
[2024-07-22 19:25:25] 1e4c68ff7df8: Download complete
[2024-07-22 19:25:25] 0dea8f52227b: Verifying Checksum
[2024-07-22 19:25:25] 0dea8f52227b: Download complete
[2024-07-22 19:25:25] aac7f4f5dfbd: Verifying Checksum
[2024-07-22 19:25:25] aac7f4f5dfbd: Download complete
[2024-07-22 19:25:25] 7ad8b309ac9a: Download complete
[2024-07-22 19:25:25] 47237141b1fe: Verifying Checksum
[2024-07-22 19:25:25] 47237141b1fe: Download complete
[2024-07-22 19:25:25] 08d359555ab8: Verifying Checksum
[2024-07-22 19:25:25] 08d359555ab8: Download complete
[2024-07-22 19:25:25] 42bb88b3690e: Verifying Checksum
[2024-07-22 19:25:25] 42bb88b3690e: Download complete
[2024-07-22 19:25:25] a2e8d3270011: Verifying Checksum
[2024-07-22 19:25:25] a2e8d3270011: Download complete
[2024-07-22 19:25:25] 61aa9f9f5090: Verifying Checksum
[2024-07-22 19:25:25] 61aa9f9f5090: Download complete
[2024-07-22 19:25:25] 57e63866fe46: Verifying Checksum
[2024-07-22 19:25:25] 57e63866fe46: Download complete
[2024-07-22 19:25:25] 9b857f539cb1: Pull complete
[2024-07-22 19:25:26] c6e4e9583515: Verifying Checksum
[2024-07-22 19:25:26] c6e4e9583515: Download complete
[2024-07-22 19:25:26] 454745ed8d31: Verifying Checksum
[2024-07-22 19:25:26] 454745ed8d31: Download complete
[2024-07-22 19:25:26] 464eddc5e83b: Verifying Checksum
[2024-07-22 19:25:26] 464eddc5e83b: Download complete
[2024-07-22 19:25:26] 2c910edb2a09: Verifying Checksum
[2024-07-22 19:25:26] 2c910edb2a09: Download complete
[2024-07-22 19:25:26] b886be5769bb: Verifying Checksum
[2024-07-22 19:25:26] b886be5769bb: Download complete
[2024-07-22 19:25:26] c65710a064c1: Verifying Checksum
[2024-07-22 19:25:26] c65710a064c1: Download complete
[2024-07-22 19:25:26] a8aa3cd86a13: Verifying Checksum
[2024-07-22 19:25:26] a8aa3cd86a13: Download complete
[2024-07-22 19:25:26] 0948dd96497c: Download complete
[2024-07-22 19:25:26] e90c3615a082: Verifying Checksum
[2024-07-22 19:25:26] e90c3615a082: Download complete
[2024-07-22 19:25:26] dcc7df304966: Download complete
[2024-07-22 19:25:26] b9f6de2761b9: Download complete
[2024-07-22 19:25:26] 4f4fb700ef54: Verifying Checksum
[2024-07-22 19:25:26] 4f4fb700ef54: Download complete
[2024-07-22 19:25:28] 7af71cb397b9: Verifying Checksum
[2024-07-22 19:25:28] 7af71cb397b9: Download complete
[2024-07-22 19:25:35] 7af71cb397b9: Pull complete
[2024-07-22 19:25:40] 0dea8f52227b: Pull complete
[2024-07-22 19:25:40] 881b32f67d5f: Pull complete
[2024-07-22 19:25:40] 182afb1fe5dc: Pull complete
[2024-07-22 19:25:40] eef3e9640d29: Pull complete
[2024-07-22 19:25:40] b7df828c981a: Pull complete
[2024-07-22 19:25:40] 05866839ed8e: Pull complete
[2024-07-22 19:25:40] 1e4c68ff7df8: Pull complete
[2024-07-22 19:25:40] aac7f4f5dfbd: Pull complete
[2024-07-22 19:25:40] 7ad8b309ac9a: Pull complete
[2024-07-22 19:25:40] 47237141b1fe: Pull complete
[2024-07-22 19:25:40] 08d359555ab8: Pull complete
[2024-07-22 19:25:40] 42bb88b3690e: Pull complete
[2024-07-22 19:25:40] a2e8d3270011: Pull complete
[2024-07-22 19:25:40] 61aa9f9f5090: Pull complete
[2024-07-22 19:25:40] 57e63866fe46: Pull complete
[2024-07-22 19:25:41] 454745ed8d31: Pull complete
[2024-07-22 19:25:41] c6e4e9583515: Pull complete
[2024-07-22 19:25:41] 464eddc5e83b: Pull complete
[2024-07-22 19:25:41] 2c910edb2a09: Pull complete
[2024-07-22 19:25:41] b886be5769bb: Pull complete
[2024-07-22 19:25:41] c65710a064c1: Pull complete
[2024-07-22 19:25:41] a8aa3cd86a13: Pull complete
[2024-07-22 19:25:41] 0948dd96497c: Pull complete
[2024-07-22 19:25:41] e90c3615a082: Pull complete
[2024-07-22 19:25:41] dcc7df304966: Pull complete
[2024-07-22 19:25:41] b9f6de2761b9: Pull complete
[2024-07-22 19:25:41] 4f4fb700ef54: Pull complete
[2024-07-22 19:25:41] Digest: sha256:04585c14ce36c2e70c9c1b60150b3c556f7cf5cebdc60ce686d2100061565601
[2024-07-22 19:25:41] Status: Downloaded newer image for heroku/builder:22
[2024-07-22 19:25:41] 22-cnb: Pulling from heroku/heroku
[2024-07-22 19:25:41] 3713021b0277: Pulling fs layer
[2024-07-22 19:25:41] 7af71cb397b9: Pulling fs layer
[2024-07-22 19:25:41] a60a4685c8e9: Pulling fs layer
[2024-07-22 19:25:41] a60a4685c8e9: Verifying Checksum
[2024-07-22 19:25:41] a60a4685c8e9: Download complete
[2024-07-22 19:25:42] 3713021b0277: Verifying Checksum
[2024-07-22 19:25:42] 3713021b0277: Download complete
[2024-07-22 19:25:43] 3713021b0277: Pull complete
[2024-07-22 19:25:45] 7af71cb397b9: Verifying Checksum
[2024-07-22 19:25:45] 7af71cb397b9: Download complete
[2024-07-22 19:25:53] 7af71cb397b9: Pull complete
[2024-07-22 19:25:53] a60a4685c8e9: Pull complete
[2024-07-22 19:25:53] Digest: sha256:d7476bdc16c636466e7842d2543274880d68e624cabca0a9de8e0d08009d529e
[2024-07-22 19:25:53] Status: Downloaded newer image for heroku/heroku:22-cnb
[2024-07-22 19:25:53] 0.20.0: Pulling from buildpacksio/lifecycle
[2024-07-22 19:25:53] f531499c6b73: Pulling fs layer
[2024-07-22 19:25:53] e8d9a567199d: Pulling fs layer
[2024-07-22 19:25:53] 058cf3d8c2ba: Pulling fs layer
[2024-07-22 19:25:53] b6824ed73363: Pulling fs layer
[2024-07-22 19:25:53] 7c12895b777b: Pulling fs layer
[2024-07-22 19:25:53] 33e068de2649: Pulling fs layer
[2024-07-22 19:25:53] 5664b15f108b: Pulling fs layer
[2024-07-22 19:25:53] 27be814a09eb: Pulling fs layer
[2024-07-22 19:25:53] 4aa0ea1413d3: Pulling fs layer
[2024-07-22 19:25:53] da7816fa955e: Pulling fs layer
[2024-07-22 19:25:53] 9aee425378d2: Pulling fs layer
[2024-07-22 19:25:53] 552063771f31: Pulling fs layer
[2024-07-22 19:25:53] 27be814a09eb: Waiting
[2024-07-22 19:25:53] 9aee425378d2: Waiting
[2024-07-22 19:25:53] 552063771f31: Waiting
[2024-07-22 19:25:53] 4aa0ea1413d3: Waiting
[2024-07-22 19:25:53] b6824ed73363: Waiting
[2024-07-22 19:25:53] 7c12895b777b: Waiting
[2024-07-22 19:25:53] 33e068de2649: Waiting
[2024-07-22 19:25:53] da7816fa955e: Waiting
[2024-07-22 19:25:53] 5664b15f108b: Waiting
[2024-07-22 19:25:53] e8d9a567199d: Verifying Checksum
[2024-07-22 19:25:53] f531499c6b73: Verifying Checksum
[2024-07-22 19:25:53] f531499c6b73: Download complete
[2024-07-22 19:25:53] f531499c6b73: Pull complete
[2024-07-22 19:25:53] b6824ed73363: Verifying Checksum
[2024-07-22 19:25:53] b6824ed73363: Download complete
[2024-07-22 19:25:53] e8d9a567199d: Pull complete
[2024-07-22 19:25:53] 7c12895b777b: Verifying Checksum
[2024-07-22 19:25:53] 7c12895b777b: Download complete
[2024-07-22 19:25:53] 33e068de2649: Download complete
[2024-07-22 19:25:53] 058cf3d8c2ba: Verifying Checksum
[2024-07-22 19:25:53] 058cf3d8c2ba: Download complete
[2024-07-22 19:25:53] 5664b15f108b: Verifying Checksum
[2024-07-22 19:25:53] 5664b15f108b: Download complete
[2024-07-22 19:25:53] 27be814a09eb: Download complete
[2024-07-22 19:25:53] 4aa0ea1413d3: Verifying Checksum
[2024-07-22 19:25:53] 4aa0ea1413d3: Download complete
[2024-07-22 19:25:53] da7816fa955e: Verifying Checksum
[2024-07-22 19:25:53] da7816fa955e: Download complete
[2024-07-22 19:25:53] 9aee425378d2: Verifying Checksum
[2024-07-22 19:25:53] 9aee425378d2: Download complete
[2024-07-22 19:25:53] 058cf3d8c2ba: Pull complete
[2024-07-22 19:25:53] b6824ed73363: Pull complete
[2024-07-22 19:25:53] 7c12895b777b: Pull complete
[2024-07-22 19:25:53] 33e068de2649: Pull complete
[2024-07-22 19:25:53] 5664b15f108b: Pull complete
[2024-07-22 19:25:53] 27be814a09eb: Pull complete
[2024-07-22 19:25:53] 4aa0ea1413d3: Pull complete
[2024-07-22 19:25:53] da7816fa955e: Pull complete
[2024-07-22 19:25:53] 9aee425378d2: Pull complete
[2024-07-22 19:25:54] 552063771f31: Verifying Checksum
[2024-07-22 19:25:54] 552063771f31: Download complete
[2024-07-22 19:25:54] 552063771f31: Pull complete
[2024-07-22 19:25:54] Digest: sha256:ba1d771ec095df94eb75a667a2fe4178cf8d6f05cde6430c89c7168cd04fcfd3
[2024-07-22 19:25:54] Status: Downloaded newer image for buildpacksio/lifecycle:0.20.0
[2024-07-22 19:25:54] ===> ANALYZING
[2024-07-22 19:25:56] [analyzer] Image with name "my-image-name" not found
[2024-07-22 19:25:56] ===> DETECTING
[2024-07-22 19:25:56] [detector] 3 of 5 buildpacks participating
[2024-07-22 19:25:56] [detector] heroku/nodejs-engine 3.2.9
[2024-07-22 19:25:56] [detector] heroku/ruby          3.0.0
[2024-07-22 19:25:56] [detector] heroku/procfile      3.1.2
[2024-07-22 19:25:56] ===> RESTORING
[2024-07-22 19:25:56] ===> BUILDING
[2024-07-22 19:25:57] [builder] 
[2024-07-22 19:25:57] [builder] [Heroku Node.js Engine Buildpack]
[2024-07-22 19:25:57] [builder] 
[2024-07-22 19:25:57] [builder] [Checking Node.js version]
[2024-07-22 19:25:57] [builder] Node.js version not specified, using 20.x
[2024-07-22 19:25:57] [builder] Resolved Node.js version: 20.15.1
[2024-07-22 19:25:57] [builder] 
[2024-07-22 19:25:57] [builder] [Installing Node.js distribution]
[2024-07-22 19:25:57] [builder] Downloading Node.js 20.15.1 (linux-amd64) from https://nodejs.org/download/release/v20.15.1/node-v20.15.1-linux-x64.tar.gz
[2024-07-22 19:25:57] [builder] Verifying checksum
[2024-07-22 19:25:57] [builder] Extracting Node.js 20.15.1 (linux-amd64)
[2024-07-22 19:25:58] [builder] Installing Node.js 20.15.1 (linux-amd64)
[2024-07-22 19:25:58] [builder] 
[2024-07-22 19:25:58] [builder] # Heroku Ruby Buildpack
[2024-07-22 19:25:58] [builder] 
[2024-07-22 19:25:58] [builder] - Metrics agent
[2024-07-22 19:25:58] [builder]   - Skipping install (`barnes` gem not found)
[2024-07-22 19:25:58] [builder] - Ruby version `3.2.4` from `Gemfile.lock`
[2024-07-22 19:25:59] [builder]   - Installing ... (0.657s)
[2024-07-22 19:25:59] [builder] - Bundler version `2.5.9` from `Gemfile.lock`
[2024-07-22 19:25:59] [builder]   - Running `gem install bundler --version 2.5.9` ... (0.441s)
[2024-07-22 19:25:59] [builder] - Bundle install
[2024-07-22 19:25:59] [builder]   - Running `BUNDLE_BIN="/layers/heroku_ruby/gems/bin" BUNDLE_CLEAN="1" BUNDLE_DEPLOYMENT="1" BUNDLE_GEMFILE="/workspace/Gemfile" BUNDLE_PATH="/layers/heroku_ruby/gems" BUNDLE_WITHOUT="development:test" bundle install`
[2024-07-22 19:25:59] [builder] 
[2024-07-22 19:26:01] [builder]       Fetching gem metadata from https://rubygems.org/.........
[2024-07-22 19:26:01] [builder]       Fetching rake 13.2.1
[2024-07-22 19:26:01] [builder]       Installing rake 13.2.1
[2024-07-22 19:26:01] [builder]       Fetching bigdecimal 3.1.8
[2024-07-22 19:26:01] [builder]       Fetching base64 0.2.0
[2024-07-22 19:26:01] [builder]       Fetching concurrent-ruby 1.2.3
[2024-07-22 19:26:01] [builder]       Fetching connection_pool 2.4.1
[2024-07-22 19:26:01] [builder]       Installing base64 0.2.0
[2024-07-22 19:26:01] [builder]       Installing bigdecimal 3.1.8 with native extensions
[2024-07-22 19:26:01] [builder]       Fetching drb 2.2.1
[2024-07-22 19:26:01] [builder]       Installing connection_pool 2.4.1
[2024-07-22 19:26:01] [builder]       Installing drb 2.2.1
[2024-07-22 19:26:01] [builder]       Fetching minitest 5.23.0
[2024-07-22 19:26:01] [builder]       Fetching mutex_m 0.2.0
[2024-07-22 19:26:01] [builder]       Installing minitest 5.23.0
[2024-07-22 19:26:01] [builder]       Installing mutex_m 0.2.0
[2024-07-22 19:26:01] [builder]       Installing concurrent-ruby 1.2.3
[2024-07-22 19:26:01] [builder]       Fetching builder 3.2.4
[2024-07-22 19:26:01] [builder]       Installing builder 3.2.4
[2024-07-22 19:26:01] [builder]       Fetching erubi 1.12.0
[2024-07-22 19:26:01] [builder]       Installing erubi 1.12.0
[2024-07-22 19:26:01] [builder]       Fetching racc 1.7.3
[2024-07-22 19:26:01] [builder]       Fetching crass 1.0.6
[2024-07-22 19:26:01] [builder]       Installing crass 1.0.6
[2024-07-22 19:26:01] [builder]       Installing racc 1.7.3 with native extensions
[2024-07-22 19:26:01] [builder]       Fetching rack 3.0.11
[2024-07-22 19:26:01] [builder]       Installing rack 3.0.11
[2024-07-22 19:26:01] [builder]       Fetching nio4r 2.7.3
[2024-07-22 19:26:01] [builder]       Fetching websocket-extensions 0.1.5
[2024-07-22 19:26:01] [builder]       Installing websocket-extensions 0.1.5
[2024-07-22 19:26:01] [builder]       Installing nio4r 2.7.3 with native extensions
[2024-07-22 19:26:01] [builder]       Fetching zeitwerk 2.6.14
[2024-07-22 19:26:01] [builder]       Installing zeitwerk 2.6.14
[2024-07-22 19:26:01] [builder]       Fetching timeout 0.4.1
[2024-07-22 19:26:01] [builder]       Installing timeout 0.4.1
[2024-07-22 19:26:01] [builder]       Fetching marcel 1.0.4
[2024-07-22 19:26:01] [builder]       Installing marcel 1.0.4
[2024-07-22 19:26:01] [builder]       Fetching mini_mime 1.1.5
[2024-07-22 19:26:01] [builder]       Installing mini_mime 1.1.5
[2024-07-22 19:26:01] [builder]       Fetching date 3.3.4
[2024-07-22 19:26:02] [builder]       Installing date 3.3.4 with native extensions
[2024-07-22 19:26:02] [builder]       Fetching msgpack 1.7.2
[2024-07-22 19:26:02] [builder]       Installing msgpack 1.7.2 with native extensions
[2024-07-22 19:26:06] [builder]       Fetching coffee-script-source 1.12.2
[2024-07-22 19:26:06] [builder]       Installing coffee-script-source 1.12.2
[2024-07-22 19:26:06] [builder]       Fetching execjs 2.8.1
[2024-07-22 19:26:06] [builder]       Installing execjs 2.8.1
[2024-07-22 19:26:06] [builder]       Fetching stringio 3.1.0
[2024-07-22 19:26:06] [builder]       Installing stringio 3.1.0 with native extensions
[2024-07-22 19:26:07] [builder]       Fetching io-console 0.7.2
[2024-07-22 19:26:07] [builder]       Installing io-console 0.7.2 with native extensions
[2024-07-22 19:26:08] [builder]       Fetching webrick 1.8.1
[2024-07-22 19:26:08] [builder]       Installing webrick 1.8.1
[2024-07-22 19:26:08] [builder]       Fetching thor 1.3.1
[2024-07-22 19:26:08] [builder]       Installing thor 1.3.1
[2024-07-22 19:26:08] [builder]       Fetching ffi 1.16.3
[2024-07-22 19:26:08] [builder]       Installing ffi 1.16.3 with native extensions
[2024-07-22 19:26:10] [builder]       Fetching rb-fsevent 0.11.2
[2024-07-22 19:26:10] [builder]       Installing rb-fsevent 0.11.2
[2024-07-22 19:26:10] [builder]       Fetching pg 1.5.6
[2024-07-22 19:26:10] [builder]       Installing pg 1.5.6 with native extensions
[2024-07-22 19:26:11] [builder]       Fetching tilt 2.1.0
[2024-07-22 19:26:11] [builder]       Installing tilt 2.1.0
[2024-07-22 19:26:11] [builder]       Fetching turbolinks-source 5.2.0
[2024-07-22 19:26:11] [builder]       Installing turbolinks-source 5.2.0
[2024-07-22 19:26:11] [builder]       Fetching i18n 1.14.5
[2024-07-22 19:26:11] [builder]       Installing i18n 1.14.5
[2024-07-22 19:26:11] [builder]       Fetching tzinfo 2.0.6
[2024-07-22 19:26:11] [builder]       Installing tzinfo 2.0.6
[2024-07-22 19:26:11] [builder]       Fetching rack-session 2.0.0
[2024-07-22 19:26:11] [builder]       Installing rack-session 2.0.0
[2024-07-22 19:26:11] [builder]       Fetching rack-test 2.1.0
[2024-07-22 19:26:11] [builder]       Installing rack-test 2.1.0
[2024-07-22 19:26:11] [builder]       Fetching sprockets 4.2.0
[2024-07-22 19:26:11] [builder]       Installing sprockets 4.2.0
[2024-07-22 19:26:11] [builder]       Fetching websocket-driver 0.7.6
[2024-07-22 19:26:11] [builder]       Installing websocket-driver 0.7.6 with native extensions
[2024-07-22 19:26:12] [builder]       Fetching net-protocol 0.2.2
[2024-07-22 19:26:12] [builder]       Installing net-protocol 0.2.2
[2024-07-22 19:26:12] [builder]       Fetching nokogiri 1.16.5 (x86_64-linux)
[2024-07-22 19:26:12] [builder]       Installing nokogiri 1.16.5 (x86_64-linux)
[2024-07-22 19:26:12] [builder]       Fetching puma 6.4.2
[2024-07-22 19:26:12] [builder]       Installing puma 6.4.2 with native extensions
[2024-07-22 19:26:13] [builder]       Fetching coffee-script 2.4.1
[2024-07-22 19:26:13] [builder]       Installing coffee-script 2.4.1
[2024-07-22 19:26:13] [builder]       Fetching uglifier 4.2.0
[2024-07-22 19:26:13] [builder]       Installing uglifier 4.2.0
[2024-07-22 19:26:13] [builder]       Fetching psych 5.1.2
[2024-07-22 19:26:13] [builder]       Installing psych 5.1.2 with native extensions
[2024-07-22 19:26:16] [builder]       Fetching bootsnap 1.18.3
[2024-07-22 19:26:16] [builder]       Installing bootsnap 1.18.3 with native extensions
[2024-07-22 19:26:17] [builder]       Fetching rackup 2.1.0
[2024-07-22 19:26:17] [builder]       Installing rackup 2.1.0
[2024-07-22 19:26:17] [builder]       Fetching reline 0.5.7
[2024-07-22 19:26:17] [builder]       Installing reline 0.5.7
[2024-07-22 19:26:17] [builder]       Fetching turbolinks 5.2.1
[2024-07-22 19:26:17] [builder]       Installing turbolinks 5.2.1
[2024-07-22 19:26:17] [builder]       Fetching net-imap 0.4.11
[2024-07-22 19:26:17] [builder]       Installing net-imap 0.4.11
[2024-07-22 19:26:17] [builder]       Fetching net-pop 0.1.2
[2024-07-22 19:26:17] [builder]       Installing net-pop 0.1.2
[2024-07-22 19:26:17] [builder]       Fetching net-smtp 0.5.0
[2024-07-22 19:26:17] [builder]       Installing net-smtp 0.5.0
[2024-07-22 19:26:17] [builder]       Fetching loofah 2.22.0
[2024-07-22 19:26:17] [builder]       Installing loofah 2.22.0
[2024-07-22 19:26:17] [builder]       Fetching activesupport 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing activesupport 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching rdoc 6.6.3.1
[2024-07-22 19:26:17] [builder]       Installing rdoc 6.6.3.1
[2024-07-22 19:26:17] [builder]       Fetching mail 2.8.1
[2024-07-22 19:26:17] [builder]       Installing mail 2.8.1
[2024-07-22 19:26:17] [builder]       Fetching rails-html-sanitizer 1.6.0
[2024-07-22 19:26:17] [builder]       Installing rails-html-sanitizer 1.6.0
[2024-07-22 19:26:17] [builder]       Fetching rails-dom-testing 2.2.0
[2024-07-22 19:26:17] [builder]       Installing rails-dom-testing 2.2.0
[2024-07-22 19:26:17] [builder]       Fetching globalid 1.2.1
[2024-07-22 19:26:17] [builder]       Installing globalid 1.2.1
[2024-07-22 19:26:17] [builder]       Fetching activemodel 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing activemodel 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching irb 1.13.1
[2024-07-22 19:26:17] [builder]       Installing irb 1.13.1
[2024-07-22 19:26:17] [builder]       Fetching sdoc 2.6.1
[2024-07-22 19:26:17] [builder]       Installing sdoc 2.6.1
[2024-07-22 19:26:17] [builder]       Fetching actionview 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing actionview 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching activejob 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing activejob 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching activerecord 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching actionpack 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing actionpack 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing activerecord 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching jbuilder 2.12.0
[2024-07-22 19:26:17] [builder]       Installing jbuilder 2.12.0
[2024-07-22 19:26:17] [builder]       Fetching actioncable 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing actioncable 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching actionmailer 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing actionmailer 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching railties 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing railties 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching sprockets-rails 3.4.2
[2024-07-22 19:26:17] [builder]       Installing sprockets-rails 3.4.2
[2024-07-22 19:26:17] [builder]       Fetching activestorage 7.1.3.2
[2024-07-22 19:26:17] [builder]       Installing activestorage 7.1.3.2
[2024-07-22 19:26:17] [builder]       Fetching actionmailbox 7.1.3.2
[2024-07-22 19:26:18] [builder]       Installing actionmailbox 7.1.3.2
[2024-07-22 19:26:18] [builder]       Fetching actiontext 7.1.3.2
[2024-07-22 19:26:18] [builder]       Installing actiontext 7.1.3.2
[2024-07-22 19:26:18] [builder]       Fetching coffee-rails 5.0.0
[2024-07-22 19:26:18] [builder]       Installing coffee-rails 5.0.0
[2024-07-22 19:26:18] [builder]       Fetching jquery-rails 4.6.0
[2024-07-22 19:26:18] [builder]       Fetching rails 7.1.3.2
[2024-07-22 19:26:18] [builder]       Installing rails 7.1.3.2
[2024-07-22 19:26:18] [builder]       Installing jquery-rails 4.6.0
[2024-07-22 19:26:18] [builder]       Fetching rb-inotify 0.10.1
[2024-07-22 19:26:18] [builder]       Fetching sassc 2.4.0
[2024-07-22 19:26:18] [builder]       Installing rb-inotify 0.10.1
[2024-07-22 19:26:18] [builder]       Fetching listen 3.9.0
[2024-07-22 19:26:18] [builder]       Installing sassc 2.4.0 with native extensions
[2024-07-22 19:26:18] [builder]       Installing listen 3.9.0
[2024-07-22 19:27:10] [builder]       Fetching sassc-rails 2.1.2
[2024-07-22 19:27:10] [builder]       Installing sassc-rails 2.1.2
[2024-07-22 19:27:10] [builder]       Fetching sass-rails 6.0.0
[2024-07-22 19:27:10] [builder]       Installing sass-rails 6.0.0
[2024-07-22 19:27:10] [builder]       Bundle complete! 13 Gemfile dependencies, 82 gems now installed.
[2024-07-22 19:27:10] [builder]       Gems in the groups 'development' and 'test' were not installed.
[2024-07-22 19:27:10] [builder]       Bundled gems are installed into `/layers/heroku_ruby/gems`
[2024-07-22 19:27:10] [builder]             
[2024-07-22 19:27:10] [builder]   - Done (1m 10s)
[2024-07-22 19:27:10] [builder] - Setting default processes
[2024-07-22 19:27:10] [builder]   - Running `bundle list` ... (0.166s)
[2024-07-22 19:27:10] [builder]   - Detected rails app (`rails` gem found)
[2024-07-22 19:27:10] [builder] - Rake assets install
[2024-07-22 19:27:10] [builder]   - Detected rake (`rake` gem found, `Rakefile` found at `/workspace/Rakefile`)
[2024-07-22 19:27:12] [builder]   - Running `bundle exec rake -P --trace` .... (1.428s)
[2024-07-22 19:27:12] [builder]   - Compiling assets with cache (detected `rake assets:precompile` and `rake assets:clean` via `bundle exec rake -P`)
[2024-07-22 19:27:12] [builder]   - Creating cache for /workspace/public/assets
[2024-07-22 19:27:12] [builder]   - Creating cache for /workspace/tmp/cache/assets
[2024-07-22 19:27:12] [builder]   - Running `bundle exec rake assets:precompile assets:clean --trace`
[2024-07-22 19:27:12] [builder] 
[2024-07-22 19:27:12] [builder]       ** Invoke assets:precompile (first_time)
[2024-07-22 19:27:12] [builder]       ** Invoke assets:environment (first_time)
[2024-07-22 19:27:12] [builder]       ** Execute assets:environment
[2024-07-22 19:27:12] [builder]       ** Invoke environment (first_time)
[2024-07-22 19:27:12] [builder]       ** Execute environment
[2024-07-22 19:27:13] [builder]       ** Execute assets:precompile
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.477065 #1500]  INFO -- : Writing /workspace/public/assets/manifest-dad05bf766af0fe3d79dd746db3c1361c0583026cdf35d6a2921bccaea835331.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.477334 #1500]  INFO -- : Writing /workspace/public/assets/manifest-dad05bf766af0fe3d79dd746db3c1361c0583026cdf35d6a2921bccaea835331.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.477659 #1500]  INFO -- : Writing /workspace/public/assets/lang-logo-b6c7c4b6a37e9c2425ca4d54561010c0719870ae325c849de398499f1ab098a9.png
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.478149 #1500]  INFO -- : Writing /workspace/public/assets/application-9ced36c9568ebfd1053e04ba411af767274dfcccd9807c0989f8bd17ca5e8f5b.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.478504 #1500]  INFO -- : Writing /workspace/public/assets/application-9ced36c9568ebfd1053e04ba411af767274dfcccd9807c0989f8bd17ca5e8f5b.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.478770 #1500]  INFO -- : Writing /workspace/public/assets/welcome-27cfb9694c5e92d25d972c2b4a2d2e222ad088aef866823f772241c1db423402.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.479093 #1500]  INFO -- : Writing /workspace/public/assets/welcome-27cfb9694c5e92d25d972c2b4a2d2e222ad088aef866823f772241c1db423402.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.479372 #1500]  INFO -- : Writing /workspace/public/assets/widgets-27cfb9694c5e92d25d972c2b4a2d2e222ad088aef866823f772241c1db423402.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.479768 #1500]  INFO -- : Writing /workspace/public/assets/widgets-27cfb9694c5e92d25d972c2b4a2d2e222ad088aef866823f772241c1db423402.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.480077 #1500]  INFO -- : Writing /workspace/public/assets/application-776d900b9840362472b5b6b4afb9b798c78d53098a77b289b8bfc22c6d241913.css
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.480979 #1500]  INFO -- : Writing /workspace/public/assets/application-776d900b9840362472b5b6b4afb9b798c78d53098a77b289b8bfc22c6d241913.css.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.481431 #1500]  INFO -- : Writing /workspace/public/assets/scaffolds-04024382391bb910584145d8113cf35ef376b55d125bb4516cebeb14ce788597.css
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.482041 #1500]  INFO -- : Writing /workspace/public/assets/scaffolds-04024382391bb910584145d8113cf35ef376b55d125bb4516cebeb14ce788597.css.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.482282 #1500]  INFO -- : Writing /workspace/public/assets/theme-776d900b9840362472b5b6b4afb9b798c78d53098a77b289b8bfc22c6d241913.css
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.482476 #1500]  INFO -- : Writing /workspace/public/assets/theme-776d900b9840362472b5b6b4afb9b798c78d53098a77b289b8bfc22c6d241913.css.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.482913 #1500]  INFO -- : Writing /workspace/public/assets/welcome-04024382391bb910584145d8113cf35ef376b55d125bb4516cebeb14ce788597.css
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.483173 #1500]  INFO -- : Writing /workspace/public/assets/welcome-04024382391bb910584145d8113cf35ef376b55d125bb4516cebeb14ce788597.css.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.484165 #1500]  INFO -- : Writing /workspace/public/assets/widgets-04024382391bb910584145d8113cf35ef376b55d125bb4516cebeb14ce788597.css
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.484437 #1500]  INFO -- : Writing /workspace/public/assets/widgets-04024382391bb910584145d8113cf35ef376b55d125bb4516cebeb14ce788597.css.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.484721 #1500]  INFO -- : Writing /workspace/public/assets/actiontext-78de0ebeae470799f9ec25fd0e20ae2d931df88c2ff9315918d1054a2fca2596.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.484843 #1500]  INFO -- : Writing /workspace/public/assets/actiontext-78de0ebeae470799f9ec25fd0e20ae2d931df88c2ff9315918d1054a2fca2596.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.485114 #1500]  INFO -- : Writing /workspace/public/assets/actiontext.esm-328ef022563f73c1b9b45ace742bd21330da0f6bd6c1c96d352d52fc8b8857e5.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.485575 #1500]  INFO -- : Writing /workspace/public/assets/actiontext.esm-328ef022563f73c1b9b45ace742bd21330da0f6bd6c1c96d352d52fc8b8857e5.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.485707 #1500]  INFO -- : Writing /workspace/public/assets/trix-e17a480fcb4e30c8571f0fed42dc81de5faeef93755ca30fe9623eb3f5c709e5.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.485798 #1500]  INFO -- : Writing /workspace/public/assets/trix-e17a480fcb4e30c8571f0fed42dc81de5faeef93755ca30fe9623eb3f5c709e5.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.486165 #1500]  INFO -- : Writing /workspace/public/assets/trix-5552afe828fe79c41e53b9cc3616e9d7b8c2de1979ea62cbd663b88426ec41de.css
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.486455 #1500]  INFO -- : Writing /workspace/public/assets/trix-5552afe828fe79c41e53b9cc3616e9d7b8c2de1979ea62cbd663b88426ec41de.css.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.486767 #1500]  INFO -- : Writing /workspace/public/assets/activestorage-503a4fe23aabfbcb752dad255f01835904e6961d5f20d1de13987a691c27d9cd.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.486916 #1500]  INFO -- : Writing /workspace/public/assets/activestorage-503a4fe23aabfbcb752dad255f01835904e6961d5f20d1de13987a691c27d9cd.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.487164 #1500]  INFO -- : Writing /workspace/public/assets/activestorage.esm-b3f7f0a5ef90530b509c5e681c4b3ef5d5046851e5b70d57fdb45e32b039c883.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.487258 #1500]  INFO -- : Writing /workspace/public/assets/activestorage.esm-b3f7f0a5ef90530b509c5e681c4b3ef5d5046851e5b70d57fdb45e32b039c883.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.487651 #1500]  INFO -- : Writing /workspace/public/assets/actioncable-1c7f008c6deb7b55c6878be38700ff6bf56b75444a086fa1f46e3b781365a3ea.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.487840 #1500]  INFO -- : Writing /workspace/public/assets/actioncable-1c7f008c6deb7b55c6878be38700ff6bf56b75444a086fa1f46e3b781365a3ea.js.gz
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.488396 #1500]  INFO -- : Writing /workspace/public/assets/actioncable.esm-06609b0ecaffe2ab952021b9c8df8b6c68f65fc23bee728fc678a2605e1ce132.js
[2024-07-22 19:27:13] [builder]       I, [2024-07-22T19:27:13.489726 #1500]  INFO -- : Writing /workspace/public/assets/actioncable.esm-06609b0ecaffe2ab952021b9c8df8b6c68f65fc23bee728fc678a2605e1ce132.js.gz
[2024-07-22 19:27:13] [builder]       ** Invoke assets:clean (first_time)
[2024-07-22 19:27:13] [builder]       ** Invoke assets:environment 
[2024-07-22 19:27:13] [builder]       ** Execute assets:clean
[2024-07-22 19:27:13] [builder]             
[2024-07-22 19:27:13] [builder]   - Done (1.261s)
[2024-07-22 19:27:13] [builder]   - Storing cache for /workspace/public/assets
[2024-07-22 19:27:13] [builder]   - Storing cache for /workspace/tmp/cache/assets
[2024-07-22 19:27:13] [builder] - Done (finished in 1m 15s)
[2024-07-22 19:27:13] [builder] 
[2024-07-22 19:27:13] [builder] [Discovering process types]
[2024-07-22 19:27:13] [builder] Procfile declares types -> web
[2024-07-22 19:27:13] ===> EXPORTING
[2024-07-22 19:27:14] [exporter] Adding layer 'heroku/nodejs-engine:dist'
[2024-07-22 19:27:16] [exporter] Adding layer 'heroku/nodejs-engine:node_runtime_metrics'
[2024-07-22 19:27:16] [exporter] Adding layer 'heroku/nodejs-engine:web_env'
[2024-07-22 19:27:16] [exporter] Adding layer 'heroku/ruby:bundler'
[2024-07-22 19:27:16] [exporter] Adding layer 'heroku/ruby:cache_public_assets'
[2024-07-22 19:27:16] [exporter] Adding layer 'heroku/ruby:cache_tmp_cache_assets'
[2024-07-22 19:27:16] [exporter] Adding layer 'heroku/ruby:env_defaults'
[2024-07-22 19:27:17] [exporter] Adding layer 'heroku/ruby:gems'
[2024-07-22 19:27:18] [exporter] Adding layer 'heroku/ruby:ruby'
[2024-07-22 19:27:18] [exporter] Adding layer 'buildpacksio/lifecycle:launch.sbom'
[2024-07-22 19:27:18] [exporter] Adding 1/1 app layer(s)
[2024-07-22 19:27:18] [exporter] Adding layer 'buildpacksio/lifecycle:launcher'
[2024-07-22 19:27:18] [exporter] Adding layer 'buildpacksio/lifecycle:config'
[2024-07-22 19:27:18] [exporter] Adding layer 'buildpacksio/lifecycle:process-types'
[2024-07-22 19:27:18] [exporter] Adding label 'io.buildpacks.lifecycle.metadata'
[2024-07-22 19:27:18] [exporter] Adding label 'io.buildpacks.build.metadata'
[2024-07-22 19:27:18] [exporter] Adding label 'io.buildpacks.project.metadata'
[2024-07-22 19:27:18] [exporter] Setting default process type 'web'
[2024-07-22 19:27:18] [exporter] Saving my-image-name...
[2024-07-22 19:27:26] [exporter] *** Images (631c6e8f6eab):
[2024-07-22 19:27:26] [exporter]       my-image-name
[2024-07-22 19:27:26] [exporter] Adding cache layer 'heroku/nodejs-engine:dist'
[2024-07-22 19:27:26] [exporter] Adding cache layer 'heroku/ruby:bundler'
[2024-07-22 19:27:26] [exporter] Adding cache layer 'heroku/ruby:cache_public_assets'
[2024-07-22 19:27:26] [exporter] Adding cache layer 'heroku/ruby:cache_tmp_cache_assets'
[2024-07-22 19:27:26] [exporter] Adding cache layer 'heroku/ruby:gems'
[2024-07-22 19:27:26] [exporter] Adding cache layer 'heroku/ruby:ruby'
[2024-07-22 19:27:27] Successfully built image 'my-image-name'
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

> [!NOTE]
> Your output may differ.

Verify that you see “Successfully built image my-image-name” at the end of the output. And verify that the image is present locally:

```
$ docker image ls --format "table {{.ID}}\t{{.Repository}}\t{{.Tag}}" | grep my-image-name
631c6e8f6eab   my-image-name            latest
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

## What does `pack build` do?

> [!NOTE]
> Skip ahead if you want to run the application first and get into the details later.

When you run `pack build` with a builder, each buildpack runs a detection script to determine if it should be eligible to build the application. In our case the `heroku/ruby` buildpack found a `Gemfile.lock` file and `heroku/nodejs-engine` buildpack found a `package.json` file on disk. As a result, both buildpacks have enough information to install Ruby and Node dependencies. You can view a list of the buildpacks used in the output above:


```
[2024-07-22 19:25:56] ===> DETECTING
[2024-07-22 19:25:56] [detector] 3 of 5 buildpacks participating
[2024-07-22 19:25:56] [detector] heroku/nodejs-engine 3.2.9
[2024-07-22 19:25:56] [detector] heroku/ruby          3.0.0
[2024-07-22 19:25:56] [detector] heroku/procfile      3.1.2
[2024-07-22 19:25:56] ===> RESTORING
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

After the detect phase, each buildpack will execute. Buildpacks can inspect your project, install files to disk, run commands, write environment variables, [and more](https://buildpacks.io/docs/for-buildpack-authors/). You can see some examples of that in the output above. For example, the Ruby buildpack installs dependencies from the `Gemfile` automatically:

```
[2024-07-22 19:25:59] [builder]   - Running `BUNDLE_BIN="/layers/heroku_ruby/gems/bin" BUNDLE_CLEAN="1" BUNDLE_DEPLOYMENT="1" BUNDLE_GEMFILE="/workspace/Gemfile" BUNDLE_PATH="/layers/heroku_ruby/gems" BUNDLE_WITHOUT="development:test" bundle install`
[2024-07-22 19:25:59] [builder] 
[2024-07-22 19:26:01] [builder]       Fetching gem metadata from https://rubygems.org/.........
[2024-07-22 19:26:01] [builder]       Fetching rake 13.2.1
[2024-07-22 19:26:01] [builder]       Installing rake 13.2.1
[2024-07-22 19:26:01] [builder]       Fetching bigdecimal 3.1.8
[2024-07-22 19:26:01] [builder]       Fetching base64 0.2.0
[2024-07-22 19:26:01] [builder]       Fetching concurrent-ruby 1.2.3
[2024-07-22 19:26:01] [builder]       Fetching connection_pool 2.4.1
[2024-07-22 19:26:01] [builder]       Installing base64 0.2.0
[2024-07-22 19:26:01] [builder]       Installing bigdecimal 3.1.8 with native extensions
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

If you’re familiar with Dockerfile you might know that [many commands in a Dockerfile will create a layer](https://dockerlabs.collabnix.com/beginners/dockerfile/Layering-Dockerfile.html). Buildpacks also use layers, but the CNB buildpack API provides for fine grained control over what exactly is in these layers and how they’re composed. Unlike Dockerfile, all images produced by CNBs [can be rebased](https://tag-env-sustainability.cncf.io/blog/2023-12-reduce-reuse-rebase-buildpacks/#reduce-reuserebase). The CNB api also improves on many of the pitfalls outlined in the satirical article [Write a Good Dockerfile in 19 'Easy' Steps](https://jkutner.github.io/2021/04/26/write-good-dockerfile.html).

## Use the image

Even though we used `pack` and CNBs to build our image, it can be run with your favorite tools like any other OCI image. We will be using the `docker` command line to run our image.

By default, images will be booted into a web server configuration. You can launch the app we just built by running:

```
$ docker run -it --rm --env PORT=9292 -p 9292:9292 my-image-name
[1] Puma starting in cluster mode...
[1] * Puma version: 6.4.2 (ruby 3.2.4-p170) ("The Eagle of Durango")
[1] *  Min threads: 5
[1] *  Max threads: 5
[1] *  Environment: production
[1] *   Master PID: 1
[1] *      Workers: 1
[1] *     Restarts: (✔) hot (✖) phased
[1] * Preloading application
[1] * Listening on http://0.0.0.0:9292
[1] Use Ctrl-C to stop
[1] ! WARNING: Detected running cluster mode with 1 worker.
[1] ! Running Puma in cluster mode with a single worker is often a misconfiguration.
[1] ! Consider running Puma in single-mode (workers = 0) in order to reduce memory overhead.
[1] ! Set the `silence_single_worker_warning` option to silence this warning message.
[1] - Worker 0 (PID: 14) booted in 0.0s, phase: 0
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

Now when you visit [http://localhost:9292](http://localhost:9292) you should see a working web application:

![Screenshot of http://localhost:9292/](screenshots/screenshot_1.png)

Don't forget to stop the docker container when you're done.


Here's a quick breakdown of that command we just ran:

- `docker run` Create and run a new container from an image.
- `-it` Makes the container interactive and allocates a TTY.
- `--rm` Automatically remove the container when it exits.
- `--env PORT=9292` Creates an environment variable named `PORT` and sets it to `9292` this is needed so the application inside the container knows what port to bind the web server.
- `-p 9292:9292` Publishes a container's port(s) to the host. This is what allows requests from your machine to be received by the container.
- `my-image-name` The name of the image you want to use for the application.

So far, we've downloaded an application via git and run a single command `pack build` to generate an image, and then we can use that image as if it was generated via a Dockerfile via the `docker run` command.

In addition to running the image as a web server, you can access the container's terminal interactively. In a new terminal window try running this command:

```
$ docker run -it --rm my-image-name bash
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

Now you can inspect the container interactively. For example, you can see the files on disk with `ls`:

```
$ ls
Gemfile
Gemfile.lock
Procfile
README.md
Rakefile
app
app.json
bin
build_output.txt
config
config.ru
db
lib
log
package.json
public
test
tmp
vendor
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

And anything else you would typically do via an interactive container session.

## Image structure under the hood

> [!NOTE]
> Skip this section if you want to try building your application with CNBs and learn about container structure later.

If you’re an advanced `Dockerfile` user you might be interested in learning more about the internal structure of the image on disk. You can access the image disk interactively by using the `bash` docker command above.

If you view the root directory `/` you’ll see there is a `layers` folder. Every buildpack that executes gets a unique folder. For example:

```
$ docker run --rm my-image-name "ls /layers | grep ruby"
heroku_ruby
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

Individual buildpacks can compose multiple layers from their buildpack directory. For example you can see that `ruby` binary is present within that ruby buildpack directory:

```
$ docker run --rm my-image-name "which ruby"
/layers/heroku_ruby/ruby/bin/ruby
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

OCI images are represented as sequential modifications to disk. By scoping buildpack disk modifications to their own directory, the CNB API guarantees that changes to a layer in one buildpack will not affect the contents of disk to another layer. This means that OCI images produced by CNBs are rebaseable by default, while those produced by Dockerfile are not.

We saw before how the image booted a web server by default. This is accomplished using an entrypoint. In another terminal outside of the running container you can view that entrypoint:

```
$ docker inspect my-image-name | grep '"Entrypoint": \[' -A2
            "Entrypoint": [
                "/cnb/process/web"
            ],
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

From within the image, you can see that file on disk:

```
$ docker run --rm my-image-name "ls /cnb/process/"
web
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

While you might not need this level of detail to build and run an application with Cloud Native Buildpacks, it is useful to understand how they’re structured if you ever want to write your own buildpack.

## Try CNBs out on your application

So far we've learned that CNBs are a declarative interface for producing OCI images (like docker). They aim to be no to low configuration and once built, you can interact with them like any other image.

For the next step, we encourage you to try running `pack` with the Heroku builder against your application and let us know how it went. We encourage you to share your experience by [opening a discussion](https://github.com/heroku/buildpacks/discussions) and walking us through what happened:

- What went well?
- What could be better?
- Do you have any questions?

We are actively working on our Cloud Native Buildpacks and want to hear about your experience. The documentation below covers some intermediate-level topics that you might find helpful.

## Configuring multiple languages

Language support is provided by individual buildpacks that are shipped with the builder. The above example uses the `heroku/ruby` buildpack which is [visible on GitHub](https://github.com/heroku/buildpacks-ruby). When you execute `pack build` with a builder, every buildpack has the opportunity to "detect" if it should execute against that project. The `heroku/ruby` buildpack looks for a `Gemfile.lock` in the root of the project and if found, knows how to detect a Ruby version and install dependencies.

In addition to this auto-detection behavior, you can specify buildpacks through the `--buildpack` flag with the `pack` CLI or through a [project.toml](https://buildpacks.io/docs/for-app-developers/how-to/build-inputs/specify-buildpacks/) file at the root of your application.

For example, if you wanted to install both Ruby, NodeJS and Python you could create a `project.toml` file in the root of your application and specify those buildpacks.

In file `project.toml` write:

```toml
[_]
schema-version = "0.2"
id = "sample.ruby+python.app"
name = "Sample Ruby & Python App"
version = "1.0.0"

[[io.buildpacks.group]]
uri = "heroku/python"

[[io.buildpacks.group]]
uri = "heroku/nodejs"

[[io.buildpacks.group]]
uri = "heroku/ruby"

[[io.buildpacks.group]]
uri = "heroku/procfile"
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

Ensure that a `requirements.txt` file, a `package.json` file and a `Gemfile.lock` file all exist and then build your application:

```
$ touch requirements.txt
$ pack build my-image-name --path .
Warning: The following keys declared in project.toml are not supported in schema version 0.2:
Warning: - _.id
Warning: - _.version
Warning: The above keys will be ignored. If this is not intentional, try updating your schema version.
22: Pulling from heroku/builder
Digest: sha256:04585c14ce36c2e70c9c1b60150b3c556f7cf5cebdc60ce686d2100061565601
Status: Image is up to date for heroku/builder:22
22-cnb: Pulling from heroku/heroku
Digest: sha256:d7476bdc16c636466e7842d2543274880d68e624cabca0a9de8e0d08009d529e
Status: Image is up to date for heroku/heroku:22-cnb
0.20.0: Pulling from buildpacksio/lifecycle
Digest: sha256:ba1d771ec095df94eb75a667a2fe4178cf8d6f05cde6430c89c7168cd04fcfd3
Status: Image is up to date for buildpacksio/lifecycle:0.20.0
===> ANALYZING
[analyzer] Restoring data for SBOM from previous image
===> DETECTING
[detector] heroku/python        0.12.1
[detector] heroku/nodejs-engine 3.2.9
[detector] heroku/ruby          3.0.0
[detector] heroku/procfile      3.1.2
===> RESTORING
[restorer] Restoring metadata for "heroku/nodejs-engine:dist" from app image
[restorer] Restoring metadata for "heroku/nodejs-engine:node_runtime_metrics" from app image
[restorer] Restoring metadata for "heroku/nodejs-engine:web_env" from app image
[restorer] Restoring metadata for "heroku/ruby:gems" from app image
[restorer] Restoring metadata for "heroku/ruby:ruby" from app image
[restorer] Restoring metadata for "heroku/ruby:bundler" from app image
[restorer] Restoring metadata for "heroku/ruby:cache_public_assets" from app image
[restorer] Restoring metadata for "heroku/ruby:cache_tmp_cache_assets" from app image
[restorer] Restoring data for "heroku/nodejs-engine:dist" from cache
[restorer] Restoring data for "heroku/ruby:bundler" from cache
[restorer] Restoring data for "heroku/ruby:cache_public_assets" from cache
[restorer] Restoring data for "heroku/ruby:cache_tmp_cache_assets" from cache
[restorer] Restoring data for "heroku/ruby:gems" from cache
[restorer] Restoring data for "heroku/ruby:ruby" from cache
===> BUILDING
[builder] 
[builder] [Determining Python version]
[builder] No Python version specified, using the current default of Python 3.12.4.
[builder] To use a different version, see: https://devcenter.heroku.com/articles/python-runtimes
[builder] 
[builder] [Installing Python and packaging tools]
[builder] Installing Python 3.12.4
[builder] Installing pip 24.1.2, setuptools 70.3.0 and wheel 0.43.0
[builder] 
[builder] [Installing dependencies using Pip]
[builder] Running pip install
[builder] 
[builder] [Heroku Node.js Engine Buildpack]
[builder] 
[builder] [Checking Node.js version]
[builder] Node.js version not specified, using 20.x
[builder] Resolved Node.js version: 20.15.1
[builder] 
[builder] [Installing Node.js distribution]
[builder] Reusing Node.js 20.15.1 (linux-amd64)
[builder] 
[builder] # Heroku Ruby Buildpack
[builder] 
[builder] - Metrics agent
[builder]   - Skipping install (`barnes` gem not found)
[builder] - Ruby version `3.2.4` from `Gemfile.lock`
[builder]   - Using cached Ruby version
[builder] - Bundler version `2.5.9` from `Gemfile.lock`
[builder]   - Using cached version
[builder] - Bundle install
[builder]   - Loading cached gems
[builder]   - Skipping `bundle install` (no changes found in /workspace/Gemfile, /workspace/Gemfile.lock, or user configured environment variables)
[builder]   - ! HELP To force run `bundle install` set `HEROKU_SKIP_BUNDLE_DIGEST=1`
[builder] - Setting default processes
[builder]   - Running `bundle list` ... (0.170s)
[builder]   - Detected rails app (`rails` gem found)
[builder] - Rake assets install
[builder]   - Detected rake (`rake` gem found, `Rakefile` found at `/workspace/Rakefile`)
[builder]   - Running `bundle exec rake -P --trace` .... (1.432s)
[builder]   - Compiling assets with cache (detected `rake assets:precompile` and `rake assets:clean` via `bundle exec rake -P`)
[builder]   - Loading cache for /workspace/public/assets
[builder]   - Loading cache for /workspace/tmp/cache/assets
[builder]   - Running `bundle exec rake assets:precompile assets:clean --trace`
[builder] 
[builder]       ** Invoke assets:precompile (first_time)
[builder]       ** Invoke assets:environment (first_time)
[builder]       ** Execute assets:environment
[builder]       ** Invoke environment (first_time)
[builder]       ** Execute environment
[builder]       ** Execute assets:precompile
[builder]       ** Invoke assets:clean (first_time)
[builder]       ** Invoke assets:environment 
[builder]       ** Execute assets:clean
[builder]             
[builder]   - Done (0.919s)
[builder]   - Storing cache for /workspace/public/assets
[builder]   - Storing cache for /workspace/tmp/cache/assets
[builder] - Done (finished in 2.726s)
[builder] 
[builder] [Discovering process types]
[builder] Procfile declares types -> web
===> EXPORTING
[exporter] Adding layer 'heroku/python:dependencies'
[exporter] Adding layer 'heroku/python:python'
[exporter] Reusing layer 'heroku/nodejs-engine:dist'
[exporter] Reusing layer 'heroku/nodejs-engine:node_runtime_metrics'
[exporter] Reusing layer 'heroku/nodejs-engine:web_env'
[exporter] Reusing layer 'heroku/ruby:bundler'
[exporter] Adding layer 'heroku/ruby:cache_public_assets'
[exporter] Adding layer 'heroku/ruby:cache_tmp_cache_assets'
[exporter] Reusing layer 'heroku/ruby:env_defaults'
[exporter] Reusing layer 'heroku/ruby:gems'
[exporter] Reusing layer 'heroku/ruby:ruby'
[exporter] Reusing layer 'buildpacksio/lifecycle:launch.sbom'
[exporter] Adding 1/1 app layer(s)
[exporter] Reusing layer 'buildpacksio/lifecycle:launcher'
[exporter] Adding layer 'buildpacksio/lifecycle:config'
[exporter] Reusing layer 'buildpacksio/lifecycle:process-types'
[exporter] Adding label 'io.buildpacks.lifecycle.metadata'
[exporter] Adding label 'io.buildpacks.build.metadata'
[exporter] Adding label 'io.buildpacks.project.metadata'
[exporter] Setting default process type 'web'
[exporter] Saving my-image-name...
[exporter] *** Images (43dc0022810f):
[exporter]       my-image-name
[exporter] Adding cache layer 'heroku/python:pip-cache'
[exporter] Adding cache layer 'heroku/python:python'
[exporter] Reusing cache layer 'heroku/nodejs-engine:dist'
[exporter] Adding cache layer 'heroku/nodejs-engine:dist'
[exporter] Reusing cache layer 'heroku/ruby:bundler'
[exporter] Adding cache layer 'heroku/ruby:bundler'
[exporter] Adding cache layer 'heroku/ruby:cache_public_assets'
[exporter] Adding cache layer 'heroku/ruby:cache_tmp_cache_assets'
[exporter] Reusing cache layer 'heroku/ruby:gems'
[exporter] Adding cache layer 'heroku/ruby:gems'
[exporter] Reusing cache layer 'heroku/ruby:ruby'
[exporter] Adding cache layer 'heroku/ruby:ruby'
Successfully built image 'my-image-name'
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

You can run the image and inspect everything is installed as expected:

```
$ docker run -it --rm my-image-name bash
$ which python
/layers/heroku_python/python/bin/python
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

## Configuring your web process with the Procfile

Most buildpacks rely on existing community standards to allow you to configure your application declaratively. They can also implement custom logic based on file contents on disk or environment variables present at build time.

The `Procfile` is a configuration file format that was [introduced by Heroku in 2011](https://devcenter.heroku.com/articles/procfile), you can now use this behavior on your CNB-powered application via the `heroku/procfile`, which like the rest of the buildpacks in our builder [is open source](https://github.com/heroku/buildpacks-procfile). The `heroku/procfile` buildpack allows you to configure your web startup process.

This is the `Procfile` of the getting started guide:

```
web: bundle exec puma -C config/puma.rb
```
<!-- STOP. This document is autogenerated. Do not manually modify. See the top of the doc for more details. -->

By including this file and using `heroku/procfile` buildpack, your application will receive a default web process. You can configure this behavior by changing the contents of that file.
 

